05

1. 
SELECT
D.DEPARTMENT_NAME NAME, MIN(E.SALARY) MINSAL, MAX(E.SALARY) MAXSAL, AVG(E.SALARY) AVGSAL
FROM EMPLOYEES E, DEPARTMENTS D
WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME
ORDER BY NAME;


2.
SELECT
E.EMPLOYEE_ID, E.DEPARTMENT_ID, E.SALARY, VT.평균
FROM EMPLOYEES E, (SELECT DEPARTMENT_ID, ROUND(AVG(SALARY),0) 평균
                           FROM EMPLOYEES
                           GROUP BY DEPARTMENT_ID) VT
WHERE E.DEPARTMENT_ID=VT.DEPARTMENT_ID AND E.SALARY>VT.평균;

3.
JDBC

SELECT
E.EMPLOYEE_ID, D.DEPARTMENT_NAME, E.SALARY, VT.평균 AVG_SALARY
FROM EMPLOYEES E, DEPARTMENTS D,
        (SELECT AVG(SALARY) 평균, DEPARTMENT_ID
         FROM EMPLOYEES
         WHERE DEPARTMENT_ID=30
         GROUP BY DEPARTMENT_ID) VT
WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID AND D.DEPARTMENT_ID=VT.DEPARTMENT_ID
ORDER BY E.EMPLOYEE_ID;










