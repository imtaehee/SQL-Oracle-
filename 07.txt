07

01
1.
SELECT
EXTRACT(MONTH FROM HIRE_DATE) 월, COUNT(*) 직원수
FROM EMPLOYEES E
GROUP BY EXTRACT(MONTH FROM HIRE_DATE) 
ORDER BY 월;

2.
SELECT
D.DEPARTMENT_NAME, E.FIRST_NAME, E.SALARY
FROM EMPLOYEES E, DEPARTMENTS D
WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID AND
          (E.SALARY, E.DEPARTMENT_ID) IN (SELECT
                                                     MAX(SALARY), DEPARTMENT_ID
                                                     FROM EMPLOYEES
                                                     GROUP BY DEPARTMENT_ID);

3.
SELECT
D.DEPARTMENT_NAME 부서명, MAX(E.SALARY) 최대급여, MIN(E.SALARY) 최소급여, AVG(E.SALARY) 평균급여
FROM EMPLOYEES E, DEPARTMENTS D
WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME
HAVING AVG(E.SALARY) > (SELECT AVG(E1.SALARY) 
                        FROM EMPLOYEES E1, DEPARTMENTS D1 
                        WHERE E1.DEPARTMENT_ID=D1.DEPARTMENT_ID AND D1.DEPARTMENT_NAME='IT'
                        GROUP BY D1.DEPARTMENT_NAME) AND
           AVG(E.SALARY) < (SELECT AVG(E2.SALARY) 
                        FROM EMPLOYEES E2, DEPARTMENTS D2
                        WHERE E2.DEPARTMENT_ID=D2.DEPARTMENT_ID AND D2.DEPARTMENT_NAME='Sales'
                        GROUP BY D2.DEPARTMENT_NAME);

4.
SELECT 
NVL(D.DEPARTMENT_NAME,'<신생부서>') 부서명, COUNT(*) 직원수
FROM EMPLOYEES E, DEPARTMENTS D
WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID(+)
GROUP BY DEPARTMENT_NAME
HAVING COUNT(*)=1
ORDER BY 부서명 DESC;

02
1.
SELECT
D.DEPARTMENT_NAME 부서명, LPAD(EXTRACT(MONTH FROM E.HIRE_DATE),2,'0') 월, COUNT(*) 직원수
FROM EMPLOYEES E, DEPARTMENTS D
WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME, EXTRACT(MONTH FROM E.HIRE_DATE)
HAVING COUNT(*)>=5
ORDER BY 부서명;

2.
SELECT
NVL(C.COUNTRY_NAME,'<부서없음>') 국가명, NVL(L.CITY, '<부서없음>') 도시명, COUNT(E.EMPLOYEE_ID) 직원수
FROM COUNTRIES C, LOCATIONS L, EMPLOYEES E, DEPARTMENTS D
WHERE C.COUNTRY_ID(+)=L.COUNTRY_ID AND D.LOCATION_ID=L.LOCATION_ID(+) AND D.DEPARTMENT_ID(+)=E.DEPARTMENT_ID
GROUP BY C.COUNTRY_NAME, L.CITY
ORDER BY C.COUNTRY_NAME;

3.
SELECT
E.EMPLOYEE_ID 직원아이디, E.FIRST_NAME 이름, E.SALARY 급여, VT.부서평균
FROM EMPLOYEES E, (SELECT MAX(SALARY) 최대급여, AVG(SALARY) 부서평균, DEPARTMENT_ID
                           FROM EMPLOYEES
                           GROUP BY DEPARTMENT_ID) VT
WHERE E.SALARY IN VT.최대급여 AND E.DEPARTMENT_ID IN VT.DEPARTMENT_ID;

4.
CREATE TABLE SALGRADE(
GRADE   NUMBER(2)  PRIMARY KEY,
LOSAL   NUMBER(5)   NOT NULL,
HISAL   NUMBER(5)    NOT NULL
);

INSERT
INTO SALGRADE (GRADE, LOSAL, HISAL)
VALUES (1, 1000, 5000);
INSERT
INTO SALGRADE (GRADE, LOSAL, HISAL)
VALUES (2, 5001, 10000);
INSERT
INTO SALGRADE (GRADE, LOSAL, HISAL)
VALUES (3, 10001, 20000);
INSERT
INTO SALGRADE (GRADE, LOSAL, HISAL)
VALUES (4, 20001, 30000);

SELECT
S.GRADE 급여등급, COUNT(*) 직원수
FROM SALGRADE S, EMPLOYEES E
WHERE E.SALARY BETWEEN S.LOSAL AND S.HISAL
GROUP BY S.GRADE
ORDER BY 급여등급;

03
1.
SELECT
NVL(TO_CHAR(TRUNC(COMMISSION_PCT,1)), '<커미션 없음>') 커미션, COUNT(*) 직원수
FROM EMPLOYEES
GROUP BY TRUNC(COMMISSION_PCT,1);

2.
SELECT
D.DEPARTMENT_NAME 부서명, E.FIRST_NAME 직원명, E.SALARY 급여, E.COMMISSION_PCT 커미션
FROM EMPLOYEES E, DEPARTMENTS D,
        (SELECT
        ROW_NUMBER() OVER(ORDER BY COMMISSION_PCT DESC, SALARY DESC) RN, COMMISSION_PCT, SALARY, EMPLOYEE_ID
        FROM EMPLOYEES
        WHERE COMMISSION_PCT IS NOT NULL) VT
WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID AND E.EMPLOYEE_ID=VT.EMPLOYEE_ID AND
          VT.RN<=4 
ORDER BY E.SALARY DESC;

3.
JDBC

SELECT
L.CITY, D.DEPARTMENT_NAME, E.FIRST_NAME, E.SALARY
FROM LOCATIONS L, DEPARTMENTS D, EMPLOYEES E
WHERE L.LOCATION_ID=D.LOCATION_ID AND D.DEPARTMENT_ID=E.DEPARTMENT_ID
          AND UPPER(L.CITY) LIKE UPPER('%lon%') AND UPPER(D.DEPARTMENT_NAME) LIKE UPPER('%resource%');




























